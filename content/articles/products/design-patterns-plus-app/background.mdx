---
title: 'バックグラウンド処理画面'
description: 'バックグラウンド処理一覧と詳細画面のレイアウトパターンをまとめています。'
order: 1
---

バックグラウンドで実行される操作のフィードバックを表すデザインパターンを定義します。

## 基本的な考え方

処理に時間がかかり、フィードバックを表示するまでに時間差が生じる場合、バックグラウンド（非同期）処理として扱います。


## 構成

バックグラウンド処理として扱うの操作のフィードバックとして、以下の画面を用意します。

- バックグラウンド処理結果への案内
- バックグラウンド処理結果の一覧画面
- バックグラウンド処理結果の詳細画面

### バックグラウンド処理結果への案内

ユーザーには、バックグラウンド処理であるかどうかはわからないため、操作後に伝える必要があります。

バックグラウンド処理が進行していることと結果をどこで確認すればよいかが伝わるようにしましょう。

案内の方法としては次のような例があげられます。

#### [NofiticationBar](/products/components/notification-bar/)で案内する場合

操作が行なわれた画面にNotificationBarでバックグラウンド処理が進行していることと結果画面へのリンクを表示します。

![スクリーンショット：NotificationBarで結果画面へのリンクを表示](./images/design-patterns-plus-app1.png)

#### [Dialog](/products/components/dialog/)で案内する場合

ユーザーが操作後、バックグラウンド処理結果の一覧画面を表示し、Dialogでバックグラウンド処理が進行していることを伝えます。

![スクリーンショット：バックグラウンド処理画面を表示し、Dialogでバックグラウンド処理が進行していることを伝える](./images/design-patterns-plus-app2.png)

もしくは、操作が行なわれた画面にDialogを表示します。Dialog上には、バックグラウンド処理が進行していることと結果画面へのリンクを表示します。

![スクリーンショット：Dialog上にバックグラウンド処理が進行していることと結果画面へのリンクを表示する](./images/design-patterns-plus-app3.png)

### バックグラウンド処理結果の一覧画面

バックグラウンド処理として受け付けた処理を一覧で表示する画面です。

#### 画面内の要素

バックグラウンド処理結果の一覧画面は以下の要素で構成されます。

- ステータス
- 処理名
- 受付日時
- 結果概要

その他の要素については必要に応じて判断してください。

一覧画面内の要素の詳細については[詳細画面の画面内の要素]()を参照してください。

#### レイアウト

![バックグラウンド処理結果の一覧画面のレイアウト](./images/design-patterns-plus-app4.png)

### バックグラウンド処理結果の詳細画面

バックグラウンド処理結果の詳細を伝える画面です。

#### 画面内の要素

バックグラウンド処理結果詳細画面は以下の要素で構成されます。

1. ステータス
2. タイトル（処理名）
3. 処理情報
    - 実行者
    - 受付日時
    - 所要時間
4. 処理結果
    - 結果詳細
    - エラー内容
    - 添付ファイル

##### 1. ステータス

処理のステータスを表示します。
ステータスについての詳細な説明は[種類]()を参照してください。

##### 2. タイトル（処理名）

操作したあとに実行された処理の内容が想像できるように、 `｛オブジェクト｝の｛操作｝`で記載します。

例：
- 評価の削除
- 従業員の一括招待
- 従業員情報のダウンロード

##### 3. 処理情報

以下のような情報をまとめて「処理情報」と呼びます。

- 実行者：従業員名もしくはメールアドレスで記載します。
- 受付日時：`2023/3/9 00:00:00`といった形式で記載します。
- 所要時間：`hoge分`、`hoge時間`といった形式で記載します。

##### 4. 処理結果

以下のような情報をまとめて「処理結果」と呼びます。

- 結果詳細
- エラー内容
- 添付ファイル
    - CSVの書き出し操作やエラーの詳細をファイルで伝える場合は、CSVファイルをダウンロードできるボタンを配置します。
    - 添付ファイルがない場合にはボタンを非表示にします。

ライティングの詳細は「[種類]()」で説明します。

#### レイアウト

![バックグラウンド処理結果の詳細画面のレイアウト](./images/design-patterns-plus-app5.png)

## 種類

バックグラウンド処理には4つの状態が存在します。

- 処理中
- 成功
- 一部失敗
- 失敗

それぞれによって、次の表示パターンが変化します。

- 一覧画面
    - [StatusLabel](/products/components/status-label/)の色と文言が変わります。
    - 結果概要の文言が変わります。
- 詳細画面
    - [StatusLabel](/products/components/status-label/)の色と文言が変わります。
    - 処理結果の結果詳細とエラー内容の文言が変わります。

### 処理中

- StatusLabel
    - `type="blue"`を使用します。
- 結果概要
    - 処理中の場合は何も表示しません。
- 処理結果
    - 処理中の場合は何も表示しません。

![処理中のバックグラウンド詳細画面](./images/design-patterns-plus-app6.png)

### 成功

- StatusLabel
    - `type="grey"`を使用します。
- 結果概要
    - 以下のようなメッセージを表示します。
        - `｛ファイル名｝を｛操作｝しました。`
        - `◯件の｛オブジェクト｝を｛操作｝しました。`
- 処理結果
    - 結果詳細に結果概要と同様の内容もしくは、次に促したい操作を表示します。
    - エラー内容には`エラーはありません。`と表示します。

![成功のバックグラウンド詳細画面](./images/design-patterns-plus-app7.png)

### 一部失敗

- StatusLabel
    - `type="warning"`を使用します。
- 結果概要
    - 以下のようなメッセージを表示します。
        - `◯件の｛オブジェクト｝の｛操作｝に成功しました。◯件の{オブジェクト}の{操作}に失敗しました。`
- 処理結果
   - 結果詳細に結果概要と同様の内容を表示します。
   - エラー内容にはエラーの原因を表示します。

![一部失敗のバックグラウンド詳細画面](./images/design-patterns-plus-app9.png)

### 失敗

- StatusLabel
  - `type="error"`を使用します。
- 結果概要
    - 以下のようなメッセージを表示します。
        - `◯件の{オブジェクト}の{操作}に失敗しました。`
- 処理結果
    - 結果詳細に結果概要と同様の内容を表示します。
    - エラー内容にはエラーの原因を表示します。

![失敗のバックグラウンド詳細画面](./images/design-patterns-plus-app8.png)

エラー内容の詳しい書き方については[エラーメッセージ](/products/contents/error-messages/#h4-0)を参照してください。
